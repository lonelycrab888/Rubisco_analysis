rm(list = ls())
library(ggplot2)

x_curve = c(
    1.        ,  1.11111111 , 1.22222222,  1.33333333,  1.44444444,  1.55555556,
    1.66666667,  1.77777778 , 1.88888889,  2.       ,   2.11111111,  2.22222222,
    2.33333333,  2.44444444 , 2.55555556,  2.66666667,  2.77777778,  2.88888889,
    3.        ,  3.11111111 , 3.22222222,  3.33333333 , 3.44444444,  3.55555556,
    3.66666667,  3.77777778 , 3.88888889,  4.       ,   4.11111111,  4.22222222,
    4.33333333,  4.44444444 , 4.55555556,  4.66666667,  4.77777778,  4.88888889,
    5.        ,  5.11111111 , 5.22222222,  5.33333333,  5.44444444,  5.55555556,
    5.66666667,  5.77777778 , 5.88888889,  6.       ,   6.11111111,  6.22222222,
    6.33333333,  6.44444444 , 6.55555556,  6.66666667,  6.77777778,  6.88888889,
    7.        ,  7.11111111 , 7.22222222,  7.33333333,  7.44444444 , 7.55555556,
    7.66666667,  7.77777778 , 7.88888889,  8.       ,   8.11111111,  8.22222222,
    8.33333333,  8.44444444 , 8.55555556,  8.66666667,  8.77777778,  8.88888889,
    9.        ,  9.11111111 , 9.22222222,  9.33333333,  9.44444444,  9.55555556,
    9.66666667,  9.77777778 , 9.88888889 , 10.       ,  10.11111111, 10.22222222,
    10.33333333, 10.44444444, 10.55555556, 10.6666666, 10.77777778, 10.88888889,
    11.       ,  11.11111111, 11.22222222, 11.33333333, 11.44444444, 11.55555556,
    11.66666667, 11.77777778, 11.88888889, 12.        )
y_curve = c(
    2.49915668,  2.72623408 , 2.96791272,  3.22446328 , 3.49608572,  3.78290151,
    4.08494604,  4.40216117 , 4.73438837,  5.08136215 , 5.44270434, 5.8179189,
    6.20638782,  6.60736781 , 7.01998821,  7.44325005 , 7.87602636,  8.31706392,
    8.76498635,  9.21829868 , 9.67539341, 10.13455809 ,10.59398434, 11.05177827,
    11.50597234, 11.95453849, 12.3954024,  12.82645884, 13.24558792, 13.65067208,
    14.03961358, 14.4103524 , 14.76088426, 15.0892785 , 15.39369581, 15.67240524,
    15.92380061, 16.14641594, 16.33893959, 16.50022721, 16.62931302, 16.72541947,
    16.78796499, 16.81656993, 16.81106033, 16.77146971, 16.69803872, 16.59121273,
    16.4516373 , 16.28015168, 16.07778045, 15.84572327, 15.58534308, 15.29815274,
    14.98580044, 14.65005394, 14.29278394, 13.9159468 , 13.52156678, 13.11171803,
    12.68850664, 12.25405281, 11.81047353, 11.35986577, 10.90429056, 10.44575792,
    9.986213  ,  9.5275233,   9.07146732,  8.61972454,  8.17386688 , 7.73535163,
    7.30551583,  6.88557223,  6.47660659,  6.07957642,  5.69531112,  5.32451324,
    4.96776101,  4.62551193,  4.29810719,  3.98577707,  3.68864698,  3.40674407,
    3.14000436,  2.88828017,  2.65134787,  2.42891566,  2.22063143,  2.02609057,
    1.8448436 ,  1.67640358,  1.52025322,  1.37585166,  1.24264082,  1.12005139,
    1.00750824,  0.90443548,  0.81026093,  0.72442017 )
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)

y <- c(2, 3, 11, 14, 14, 17, 14, 14, 6, 4, 0, 3)
data <- data.frame(x = x , y = y)
curve_data <- data.frame(x = x_curve, y = y_curve)
scatter_plot <- ggplot(data, aes(x = x, y = y)) +
  geom_bar(stat = "identity", fill = "blue")+
  #labs(title = "Scatter Plot with Fitted Gaussian (Normal) Distribution", x = "X", y = "Y") +
  theme_minimal()


scatter_with_curve_plot <-ggplot(data, aes(x = x, y = y)) +
  geom_bar(stat = "identity", fill = "blue")+
  #labs(title = "Scatter Plot with Fitted Gaussian (Normal) Distribution", x = "X", y = "Y") +
  theme_minimal() +
  geom_line(data = curve_data, aes(x = x, y = y), color = "red", size = 0.8) +
  theme_classic() +
  scale_x_continuous(expand = c(0, 0), name = "carvoxysome size (nm)", limits = c(0, 13), 
                     breaks = c(0,1, 3, 5,7,9, 11,13), labels = c(" ", 145, 165, 185, 205, 225, 245, 265)) +
  scale_y_continuous(expand = c(0, 0), name = "number of carboxysomes", limits = c(0, 20), 
                     breaks = seq(0, 20, by = 5)) +
  theme(
    axis.title.x = element_text(color = "black", size = 20),
    axis.title.y = element_text(color = "black", size = 20),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    plot.margin = unit(rep(1, 4), 'cm')
  )



print(scatter_with_curve_plot)





